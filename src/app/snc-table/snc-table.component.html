
<div id="filtros" fxLayout="row" fxLayoutAlign="start start">
  <!-- <div>
    <h3 class="total" *ngIf="count > 0">Estados: 0</h3>
  </div> -->
  <div>
    <h3 class="total" *ngIf="count > 0">Municípios: {{count}}</h3>
  </div>
</div>

<mat-card id="tabela">
  <mat-paginator fxLayoutAlign="end end" [length]="count" [pageSize]="10" (page)="onTrocaPagina($event)"></mat-paginator>

  <mat-table #snctable [dataSource]="sncDataSource" matSort>
    <ng-container matColumnDef="nome_municipio">
      <mat-header-cell *matHeaderCellDef mat-sort-header matTooltip="Ordenar A-Z" matTooltipPosition="before">MUNICÍPIO</mat-header-cell>
      <mat-cell *matCellDef="let entidade"> {{entidade.municipioUF}} </mat-cell>
    </ng-container>

    <ng-container matColumnDef="data_adesao">
      <mat-header-cell *matHeaderCellDef mat-sort-header matTooltip="Ordenar A-Z" matTooltipPosition="before">DATA DA ADESÃO</mat-header-cell>
      <mat-cell *matCellDef="let entidade"> {{entidade.data_adesao | date: 'dd/MM/y'}} </mat-cell>
    </ng-container>

    <ng-container matColumnDef="plano_trabalho">
      <mat-header-cell *matHeaderCellDef>DETALHAR</mat-header-cell>
      <mat-cell *matCellDef="let entidade">
        <a href="http://hmg.snc.cultura.gov.br/adesao/detalhar/{{entidade.id}}" class="detalhe-municipio" target="_blank">
          <i class="material-icons">insert_drive_file</i>
        </a>
        <!-- <a href="http://localhost:8000/gestao/detalhar/{{entidade.id}}" class="detalhe-municipio">
          <i class="material-icons">insert_drive_file</i>
        </a> -->
      </mat-cell>
    </ng-container>

    <ng-container matColumnDef="expandedDetail">
      <mat-cell *matCellDef="let entidade">
        <div *ngFor='let item of toArray(entidade.element.acoes_plano_trabalho); let i = index;'>
          <div *ngIf="item.value.situacao && item.value.situacao=='Concluída'">
            <p>{{item.key}} <i class="material-icons">check</i></p>
          </div>
          <div *ngIf="item.value.situacao && item.value.situacao!=='Concluída'">
            <p>{{item.key}} <i class="material-icons">close</i></p>
          </div>
        </div>
      </mat-cell>
    </ng-container>

    <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
    <mat-row *matRowDef="let row; columns: displayedColumns;" matRipple class="element-row" [class.expanded]="expandedElement == row"
      (click)="expandedElement = row"></mat-row>
    <mat-row *matRowDef="let row; columns: ['expandedDetail']; when: isExpansionDetailRow" [@detailExpand]="row.element == expandedElement ? 'expanded' : 'collapsed'"
      style="overflow: hidden">
    </mat-row>

  </mat-table>
</mat-card>